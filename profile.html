<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - JBR7 Bags Manufacturing</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/home.css">
    <link rel="stylesheet" href="/JBR7 CSS/profile.css">
    <link rel="stylesheet" href="/JBR7 CSS/settings.css">
</head>
<body>
    <header>
        <a href="/home.html" class="logo">
            <img src="/JBR7 BAGS LOGO.jpg" alt="JBR7 BAGS LOGO" class="logo-img" onerror="this.style.display='none'">
            <div class="logo-text">
                <h2><span>JBR7</span> BAGS</h2>
                <span class="sub-logo">MANUFACTURING</span>
            </div>
        </a>
        <div class="header-sep" aria-hidden="true"></div>
        <nav>
            <a href="#home" onclick="handleNavigate('home')" data-page="home" class="active"><i class="fas fa-home"></i> Home</a>
            <a href="#explore" onclick="handleNavigate('explore')" data-page="explore"><i class="fas fa-compass"></i> Explore</a>
            <a href="#saved" onclick="handleNavigate('saved')" data-page="saved"><i class="fas fa-bookmark"></i> Saved</a>
            <a href="#cart" onclick="handleNavigate('cart')" data-page="cart"><i class="fas fa-shopping-cart"></i> Cart</a>
            <a href="#contact" onclick="handleNavigate('contact')" data-page="contact"><i class="fas fa-envelope"></i> Contact Us</a>
            <a href="#settings" onclick="handleNavigate('settings')" data-page="settings"><i class="fas fa-cog"></i> Settings</a>
            <a href="#search" onclick="handleNavigate('search')" data-page="search"><i class="fas fa-search"></i></a>
            <a href="#notifications" onclick="handleNavigate('notifications')" data-page="notifications"><i class="fas fa-bell"></i></a>
            <a href="#messages" onclick="handleNavigate('messages')" data-page="messages"><i class="fas fa-comment"></i></a>
            <a href="#profile" onclick="handleNavigate('profile')" data-page="profile"><i class="fas fa-user-circle"></i></a>
        </nav>
    </header>

    <!-- Removed meta-refresh so profile.html can be served directly and populated via client-side JS -->
    <div class="profile-container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-cover"></div>
            <div class="profile-info-wrapper">
                <div class="profile-avatar-section">
                    <div class="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <button class="edit-avatar-btn" onclick="editAvatar()">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <div class="profile-details">
                    <h1 class="profile-name"></h1>
                    <p class="profile-email"><i class="fas fa-envelope"></i> </p>
                    <p class="profile-member-since"><i class="fas fa-calendar-alt"></i></p>
                    <div class="profile-actions">
                        <button class="btn-primary" onclick="handleNavigate('settings')">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                        <button class="btn-secondary" onclick="shareProfile()">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Stats -->
        <div class="profile-stats">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-shopping-bag"></i>
                </div>
                <div class="stat-info">
                    <h3 class="stat-number">0</h3>
                    <p class="stat-label">Total Orders</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-bookmark"></i>
                </div>
                <div class="stat-info">
                    <h3 class="stat-number">0</h3>
                    <p class="stat-label">Saved Items</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <div class="stat-info">
                    <h3 class="stat-number">0</h3>
                    <p class="stat-label">Favorites</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="stat-info">
                    <h3 class="stat-number">0</h3>
                    <p class="stat-label">Reviews</p>
                </div>
            </div>
        </div>

        <!-- Profile Content -->
        <div class="profile-content">
            
            <!-- Sidebar -->
            <div class="profile-sidebar">
                <div class="profile-menu">
                    <button class="profile-menu-item active" onclick="showProfileSection('orders')" data-section="orders">
                        <i class="fas fa-box"></i>
                        <span>My Orders</span>
                    </button>
                    <button class="profile-menu-item" onclick="showProfileSection('wishlist')" data-section="wishlist">
                        <i class="fas fa-heart"></i>
                        <span>Wishlist</span>
                    </button>
                    <button class="profile-menu-item" onclick="showProfileSection('reviews')" data-section="reviews">
                        <i class="fas fa-star"></i>
                        <span>My Reviews</span>
                    </button>
                    <button class="profile-menu-item" onclick="showProfileSection('rewards')" data-section="rewards">
                        <i class="fas fa-gift"></i>
                        <span>Rewards</span>
                    </button>
                    <button class="profile-menu-item" onclick="showProfileSection('activity')" data-section="activity">
                        <i class="fas fa-history"></i>
                        <span>Activity</span>
                    </button>
                    <button class="profile-menu-item" onclick="showProfileSection('shipping')" data-section="shipping">
                        <i class="fas fa-truck"></i>
                        <span>Shipping Addresses</span>
                    </button>
                    <button class="profile-menu-item logout-item" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>

                <!-- Loyalty Card -->
                <div class="loyalty-card">
                    <div class="loyalty-header">
                        <i class="fas fa-crown"></i>
                        <span>Gold Member</span>
                    </div>
                    <div class="loyalty-points">
                        <h3>0</h3>
                        <p>Loyalty Points</p>
                    </div>
                    <div class="loyalty-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 65%;"></div>
                        </div>
                        <p0/p>
                    </div>
                    <button class="loyalty-btn" onclick="viewRewards()">View Rewards</button>
                </div>
            </div>

            <!-- Main Content -->
            <div class="profile-main">
                
                <!-- Orders Section -->
                <div class="profile-section active" id="orders-section">
                    <div class="section-header">
                        <h2>My Orders</h2>
                        <div class="order-filters">
                            <button class="filter-btn active" onclick="filterOrders('all')">All</button>
                            <button class="filter-btn" onclick="filterOrders('processing')">Processing</button>
                            <button class="filter-btn" onclick="filterOrders('shipped')">Shipped</button>
                            <button class="filter-btn" onclick="filterOrders('delivered')">Delivered</button>
                        </div>
                    </div>

                    

                <!-- Wishlist Section -->
                <div class="profile-section" id="wishlist-section" style="display: none;">
                    <div class="section-header">
                        <h2>My Wishlist</h2>
                        <button class="btn-text" onclick="clearWishlist()">Clear All</button>
                    </div>

                    <div class="wishlist-grid">
                        %%SAVED_ITEMS_HTML%%
                    </div>
                </div>

                <!-- Reviews Section -->
                <div class="profile-section" id="reviews-section" style="display: none;">
                    <div class="section-header">
                        <h2>My Reviews</h2>
                    </div>

                    <div class="reviews-list">
                        <div class="review-item">
                            <div class="review-product">
                                <img src="https://www.sourceforthegoose.com/cdn/shop/files/Scallop-top-jute-tote.jpg?v=1713019103&width=1080" alt="Product">
                                <div>
                                    <h3>Premium Jute Tote Bag</h3>
                                    <p class="review-date">Reviewed on December 21, 2024</p>
                                </div>
                            </div>
                            <div class="review-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <p class="review-text">"Excellent quality bag! The jute material is very durable and the scallop design is beautiful. Perfect for grocery shopping and daily use. Highly recommend!"</p>
                            <div class="review-actions">
                                <button class="btn-text" onclick="editReview(this)"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-text" onclick="deleteReview(this)"><i class="fas fa-trash"></i> Delete</button>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="review-product">
                                <img src="https://www.teqler.com/media/_processed_/6/8/csm_T131370_70518ba90d.jpg" alt="Product">
                                <div>
                                    <h3>Canvas Shopping Bag</h3>
                                    <p class="review-date">Reviewed on December 15, 2024</p>
                                </div>
                            </div>
                            <div class="review-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                            <p class="review-text">"Great canvas bag with lots of space. The custom logo printing turned out perfect. Only wish it had more internal pockets."</p>
                            <div class="review-actions">
                                <button class="btn-text" onclick="editReview(this)"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-text" onclick="deleteReview(this)"><i class="fas fa-trash"></i> Delete</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rewards Section -->
                <div class="profile-section" id="rewards-section" style="display: none;">
                    <div class="section-header">
                        <h2>Rewards & Points</h2>
                    </div>

                    <div class="rewards-summary">
                        <div class="rewards-card-large">
                            <div class="rewards-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <h3>2,450 Points</h3>
                            <p>Available to redeem</p>
                            <button class="btn-primary" onclick="redeemPoints()">Redeem Points</button>
                        </div>
                    </div>

                    <div class="rewards-available">
                        <h3>Available Rewards</h3>
                        <div class="rewards-grid">
                            <div class="reward-item">
                                <div class="reward-icon"><i class="fas fa-tag"></i></div>
                                <h4>10% Off Coupon</h4>
                                <p class="reward-cost">500 points</p>
                                <button class="btn-secondary" onclick="claimReward(500)">Claim</button>
                            </div>
                            <div class="reward-item">
                                <div class="reward-icon"><i class="fas fa-shipping-fast"></i></div>
                                <h4>Free Shipping</h4>
                                <p class="reward-cost">300 points</p>
                                <button class="btn-secondary" onclick="claimReward(300)">Claim</button>
                            </div>
                            <div class="reward-item">
                                <div class="reward-icon"><i class="fas fa-percent"></i></div>
                                <h4>20% Off Coupon</h4>
                                <p class="reward-cost">1000 points</p>
                                <button class="btn-secondary" onclick="claimReward(1000)">Claim</button>
                            </div>
                            <div class="reward-item">
                                <div class="reward-icon"><i class="fas fa-gift"></i></div>
                                <h4>Free Custom Logo</h4>
                                <p class="reward-cost">800 points</p>
                                <button class="btn-secondary" onclick="claimReward(800)">Claim</button>
                            </div>
                        </div>
                    </div>

                    <div class="points-history">
                        <h3>Points History</h3>
                        <div class="history-item">
                            <div class="history-info">
                                <strong>Order Purchase</strong>
                                <span>December 20, 2024</span>
                            </div>
                            <span class="points-earned">+150 pts</span>
                        </div>
                        <div class="history-item">
                            <div class="history-info">
                                <strong>Product Review</strong>
                                <span>December 21, 2024</span>
                            </div>
                            <span class="points-earned">+50 pts</span>
                        </div>
                        <div class="history-item">
                            <div class="history-info">
                                <strong>Redeemed: 10% Off Coupon</strong>
                                <span>December 18, 2024</span>
                            </div>
                            <span class="points-redeemed">-500 pts</span>
                        </div>
                    </div>
                </div>

                <!-- Activity Section -->
                <div class="profile-section" id="activity-section" style="display: none;">
                    <div class="section-header">
                        <h2>Recent Activity</h2>
                    </div>

                    <div class="activity-timeline">
                        <div class="activity-item">
                            <div class="activity-icon viewed">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Viewed Product</strong>
                                <p>Leather Messenger Bag</p>
                                <span class="activity-time">2 hours ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon added">
                                <i class="fas fa-cart-plus"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Added to Cart</strong>
                                <p>Urban Commuter Backpack</p>
                                <span class="activity-time">5 hours ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon saved">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Saved to Wishlist</strong>
                                <p>Weekend Duffel Bag</p>
                                <span class="activity-time">Yesterday</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon reviewed">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Left a Review</strong>
                                <p>Premium Jute Tote Bag - 5 stars</p>
                                <span class="activity-time">2 days ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon ordered">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Order Delivered</strong>
                                <p>Order #JBR7-2024-001</p>
                                <span class="activity-time">1 week ago</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Shipping Addresses Section -->
                <div class="profile-section" id="shipping-section" style="display: none;">
                    <div class="section-header">
                        <h2>Shipping Addresses</h2>
                    </div>

                    <div class="settings-card">
                        <div class="address-item">
                            <div class="address-info">
                                <strong>Home</strong>
                                <p>John Doe<br>
                                123 Main Street, Barangay San Antonio<br>
                                Makati City, Metro Manila 1200<br>
                                Philippines<br>
                                +63 912 345 6789</p>
                            </div>
                            <div class="address-actions">
                                <span class="default-badge">Default</span>
                                <button class="btn-text" onclick="editAddress()"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-text" onclick="removeAddress()"><i class="fas fa-trash"></i> Delete</button>
                            </div>
                        </div>
                        <div class="address-item">
                            <div class="address-info">
                                <strong>Office</strong>
                                <p>John Doe<br>
                                456 Business Ave, BGC<br>
                                Taguig City, Metro Manila 1630<br>
                                Philippines<br>
                                +63 912 345 6789</p>
                            </div>
                            <div class="address-actions">
                                <button class="btn-text" onclick="setDefaultAddress()">Set as Default</button>
                                <button class="btn-text" onclick="editAddress()"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-text" onclick="removeAddress()"><i class="fas fa-trash"></i> Delete</button>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="addAddress()">
                            <i class="fas fa-plus"></i> Add New Address
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>JBR7 BAGS</h3>
                <p>Manufacturing quality bags since day one.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><span onclick="handleFooterNavigate('about')">About Us</span></li>
                    <li><span onclick="handleFooterNavigate('products')">Products</span></li>
                    <li><span onclick="handleFooterNavigate('contact')">Contact</span></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contact Info</h4>
                <p>Email: roquejennylynbatac@gmail.com</p>
                <p>Phone: +639216821649</p>
            </div>
            <div class="footer-section">
                <h4>Follow Us</h4>
                <div class="social-icons">
                    <span onclick="handleSocialClick('facebook')"><i class="fab fa-facebook"></i></span>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 JBR7 Bags Manufacturing. All rights reserved.</p>
        </div>
    </footer>
    

    <script src="/jbr7js/home.js"></script>
    <script src="/jbr7js/profile.js"></script>
    <script src="/jbr7js/settings.js"></script>
    <script src="/jbr7js/notifications.js"></script>
    <script src="/jbr7js/view-linker.js"></script>

    <script>
    // Ensure the profile fetch runs after profile.js loads (idempotent)
    try {
        if (typeof fetchSessionAndPopulateProfile === 'function') {
            fetchSessionAndPopulateProfile();
        }
    } catch (e) {
        console.warn('Failed to trigger profile fetch from profile.html', e);
    }
    </script>

</body>
<script>
// Minimal helpers used by server-rendered saved items on the profile page.
function removeFromWishlistByTitle(title) {
    if (!confirm('Remove "' + decodeURIComponent(title) + '" from saved items?')) return;
    const payload = { title: decodeURIComponent(title) };
    fetch('/jbr7php/delete_saved_item.php', {
        method: 'POST',
        credentials: 'same-origin',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
    }).then(res => {
        if (res.ok) {
            location.reload();
        } else {
            alert('Failed to remove saved item');
        }
    }).catch(() => alert('Network error'));
}

function moveSavedToCart(title, price, image) {
    try {
        const item = { name: decodeURIComponent(title), price: decodeURIComponent(price), image: decodeURIComponent(image), quantity: 1 };
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        const idx = cart.findIndex(c => c.name === item.name);
        if (idx > -1) cart[idx].quantity = (cart[idx].quantity || 0) + 1; else cart.push(item);
        localStorage.setItem('cart', JSON.stringify(cart));
        // update badge if helper present
        try { if (window.updateNavBadge) window.updateNavBadge(); else if (typeof updateCartCount === 'function') updateCartCount(); } catch (e) {}
        alert(item.name + ' added to cart');
    } catch (e) { console.warn(e); alert('Failed to add to cart'); }
}
</script>
</body>
</html>